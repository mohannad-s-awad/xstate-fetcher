{"version":3,"file":"xstate-fetcher.js","sources":["../src/Cache.ts","../src/LastEvent.ts","../src/Fetcher.ts","../.yarn/cache/xstate-npm-4.33.2-c714ff5673-6e10bcfe66.zip/node_modules/xstate/lib/_virtual/_tslib.js","../.yarn/cache/xstate-npm-4.33.2-c714ff5673-6e10bcfe66.zip/node_modules/xstate/lib/constants.js","../.yarn/cache/xstate-npm-4.33.2-c714ff5673-6e10bcfe66.zip/node_modules/xstate/lib/environment.js","../.yarn/cache/xstate-npm-4.33.2-c714ff5673-6e10bcfe66.zip/node_modules/xstate/lib/utils.js","../src/Proxy.ts","../src/Integration.ts"],"sourcesContent":["import { type Interpreter, type State } from \"@src/Fetcher\";\n\nconst createCache = () => new Cache();\n\nclass Cache {\n  private _entries: Entry[] = [];\n  private _subscriptions: Subscription[] = [];\n\n  public has(key: Key): boolean {\n    return this._findIndex(key) !== -1;\n  }\n\n  // @todo Disable fetcher if not set to keep active?\n  public set(key: Key, fetcher: Interpreter, options: CacheOptions = {}): void {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex !== -1) {\n      this._remove(entryIndex);\n    }\n\n    const { cacheTime, keepActive } = options;\n    const entry: Entry = {\n      key,\n      fetcher,\n\n      cacheTime: cacheTime ?? Number.POSITIVE_INFINITY,\n\n      activatorsCount: 0,\n      keepActive: keepActive ?? false,\n\n      subscribeFns: [],\n      unsubscribeFn: () => {},\n    };\n\n    entry.subscribeFns = this._filterSubscribeFns(this._subscriptions, entry);\n    entry.unsubscribeFn = fetcher.subscribe((state) =>\n      this._notifySubscribeFns(state, entry)\n    ).unsubscribe;\n\n    this._entries.push(entry);\n  }\n\n  public get(key: Key): ReadonlyEntry {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    return this._entries[entryIndex];\n  }\n\n  public remove(key: Key): void {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    this._remove(entryIndex);\n  }\n\n  public setCacheTime(key: Key, cacheTime: number): void {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    this._setCacheTime(entryIndex, cacheTime);\n  }\n\n  public getCacheTime(key: Key): number {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    const entry = this._entries[entryIndex];\n\n    return entry.cacheTime;\n  }\n\n  public setKeepActive(key: Key, keepActive: boolean): void {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    const entry = this._entries[entryIndex];\n\n    if (keepActive && !entry.keepActive && entry.activatorsCount === 0) {\n      entry.fetcher.send({ type: \"ENABLE\" });\n    }\n\n    entry.keepActive = keepActive;\n  }\n\n  public getKeepActive(key: Key): boolean {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    const entry = this._entries[entryIndex];\n\n    return entry.keepActive;\n  }\n\n  public activate(key: Key): void {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    const entry = this._entries[entryIndex];\n\n    if (++entry.activatorsCount === 1 && entry.cacheTimeout !== undefined) {\n      clearTimeout(entry.cacheTimeout);\n    }\n  }\n\n  public deactivate(key: Key): void {\n    const entryIndex = this._findIndex(key);\n\n    if (entryIndex === -1) {\n      throw new Error(\"Cannot find an entry with this key!\");\n    }\n\n    const entry = this._entries[entryIndex];\n\n    if (--entry.activatorsCount === 0) {\n      if (entry.cacheTime !== Number.POSITIVE_INFINITY) {\n        entry.cacheTimeout = setTimeout(() => {\n          entry.cacheTimeout = undefined;\n\n          this._remove(entryIndex);\n        }, entry.cacheTime);\n      }\n\n      if (!entry.keepActive) {\n        entry.fetcher.send({ type: \"DISABLE\" });\n      }\n    }\n  }\n\n  public filter(key: Key, options?: FilterOptions): ReadonlyEntry[] {\n    return this._entries.filter(\n      (entry) =>\n        this._matchKeys(entry.key, key, options?.isExact) &&\n        (options?.predicateFn === undefined || options.predicateFn(entry))\n    );\n  }\n\n  public batch(key: Key, batchFn: BatchFn, options?: FilterOptions): void {\n    this.filter(key, options).forEach(batchFn);\n  }\n\n  public subscribe(subscriptions: Subscription[]): UnsubscribeFn {\n    this._subscriptions.push(...subscriptions);\n\n    this._entries.forEach((entry) => {\n      entry.subscribeFns.push(\n        ...this._filterSubscribeFns(subscriptions, entry)\n      );\n    });\n\n    return () =>\n      subscriptions.forEach((subscription) => {\n        const subscriptionIndex = this._subscriptions.indexOf(subscription);\n\n        this._subscriptions.splice(subscriptionIndex, 1);\n\n        this._entries.forEach((entry) => {\n          const subscribeFnIndex = entry.subscribeFns.indexOf(\n            subscription.subscribeFn\n          );\n\n          entry.subscribeFns.splice(subscribeFnIndex, 1);\n        });\n      });\n  }\n\n  private _findIndex(key: Key): number {\n    return this._entries.findIndex((entry) =>\n      this._matchKeys(entry.key, key, true)\n    );\n  }\n\n  private _matchKeys(\n    sourceKey: Key,\n    targetKey: Key,\n    isExact: boolean = false\n  ): boolean {\n    if (sourceKey === targetKey) {\n      return true;\n    }\n\n    if (\n      typeof sourceKey === \"object\" &&\n      sourceKey !== null &&\n      typeof targetKey === \"object\" &&\n      targetKey !== null\n    ) {\n      const sourceKeyKeys = Object.keys(sourceKey);\n      const targetKeyKeys = Object.keys(targetKey);\n\n      if (!isExact || sourceKeyKeys.length === targetKeyKeys.length) {\n        return (isExact ? sourceKeyKeys : targetKeyKeys).every((key) =>\n          this._matchKeys(\n            Array.isArray(sourceKey) ? sourceKey[Number(key)] : sourceKey[key],\n            Array.isArray(targetKey) ? targetKey[Number(key)] : targetKey[key],\n            isExact\n          )\n        );\n      }\n    }\n\n    return false;\n  }\n\n  private _setCacheTime(entryIndex: number, cacheTime: number): void {\n    if (cacheTime < 0) {\n      throw new Error(\"Cannot set the cache time to a negative number!\");\n    }\n\n    const entry = this._entries[entryIndex];\n\n    if (entry.cacheTimeout !== undefined) {\n      clearTimeout(entry.cacheTimeout);\n\n      entry.cacheTimeout =\n        cacheTime !== Number.POSITIVE_INFINITY\n          ? setTimeout(\n              () => {\n                entry.cacheTimeout = undefined;\n\n                this._remove(entryIndex);\n              },\n              entry.cacheTime !== Number.POSITIVE_INFINITY\n                ? Math.max(cacheTime - entry.cacheTime, 0)\n                : cacheTime\n            )\n          : undefined;\n    }\n\n    entry.cacheTime = cacheTime;\n  }\n\n  private _filterSubscribeFns(\n    subscriptions: Subscription[],\n    entry: Entry\n  ): SubscribeFn[] {\n    return subscriptions\n      .filter((subscription) =>\n        (subscription.keys ?? [subscription.key]).some(\n          (subscriptionKey) =>\n            this._matchKeys(entry.key, subscriptionKey, subscription.isExact) &&\n            (subscription.predicateFn === undefined ||\n              subscription.predicateFn(entry))\n        )\n      )\n      .map((subscription) => {\n        if (entry.subscribeFns.includes(subscription.subscribeFn)) {\n          throw new Error(\n            \"Cannot reuse a subscribe function with the same entry!\"\n          );\n        }\n\n        return subscription.subscribeFn;\n      });\n  }\n\n  private _notifySubscribeFns(state: State, entry: Entry): void {\n    entry.subscribeFns.forEach((subscribeFn) =>\n      queueMicrotask(() => subscribeFn({ state, entry }))\n    );\n  }\n\n  private _remove(entryIndex: number): void {\n    const entry = this._entries[entryIndex];\n\n    if (entry.activatorsCount !== 0) {\n      throw new Error(\"Cannot remove an active entry!\");\n    }\n\n    if (entry.cacheTimeout !== undefined) {\n      clearTimeout(entry.cacheTimeout);\n\n      entry.cacheTimeout = undefined;\n    }\n\n    entry.unsubscribeFn();\n\n    this._entries.splice(entryIndex, 1);\n  }\n}\n\ntype Entry = {\n  key: Key;\n  fetcher: Interpreter;\n\n  cacheTime: number;\n  cacheTimeout?: Timeout;\n\n  activatorsCount: number;\n  keepActive: boolean;\n\n  subscribeFns: SubscribeFn[];\n  unsubscribeFn: UnsubscribeFn;\n};\n\ntype ReadonlyEntry = Readonly<Omit<Entry, \"cacheTimeout\" | \"unsubscribeFn\">>;\n\ntype CacheOptions = Partial<Pick<Entry, \"cacheTime\" | \"keepActive\">>;\n\ntype Key =\n  | undefined\n  | null\n  | boolean\n  | number\n  | bigint\n  | string\n  | symbol\n  | Key[]\n  | { [key: number | string | symbol]: Key };\n\ntype Timeout = ReturnType<typeof setTimeout>;\n\ntype FilterOptions = {\n  isExact?: boolean;\n  predicateFn?: FilterPredicateFn;\n};\n\ntype FilterPredicateFn = (entry: ReadonlyEntry) => boolean;\ntype BatchFn = (entry: ReadonlyEntry) => void;\n\ntype Subscription = {\n  key?: Key;\n  keys?: Key[];\n  isExact?: boolean;\n  predicateFn?: FilterPredicateFn;\n  subscribeFn: SubscribeFn;\n};\n\ntype SubscribeFn = (parameters: SubscribeFnParameters) => void;\n\ntype SubscribeFnParameters = {\n  state: State;\n  entry: ReadonlyEntry;\n};\n\ntype UnsubscribeFn = () => void;\n\nexport {\n  createCache,\n  Cache,\n  type BatchFn,\n  type Entry,\n  type FilterOptions,\n  type FilterPredicateFn,\n  type Key,\n  type CacheOptions,\n  type ReadonlyEntry,\n  type SubscribeFn,\n  type SubscribeFnParameters,\n  type Subscription,\n  type Timeout,\n  type UnsubscribeFn,\n};\n","import { AnyState } from \"xstate\";\n\nconst getLastEvent = <TEvents>(state: AnyState): TEvents =>\n  state.event.type !== \"\"\n    ? state.event\n    : state.history !== undefined\n    ? getLastEvent(state.history)\n    : undefined;\n\nexport { getLastEvent };\n","import {\n  actions,\n  createMachine,\n  type DoneInvokeEvent,\n  type InterpreterFrom,\n  type StateFrom,\n} from \"xstate\";\n\nimport { getLastEvent } from \"@src/LastEvent\";\n\n// @todo Support typing of data and aborter\nconst createFetcher = (options: FetcherOptions = {}) => {\n  const fetcher = createMachine(\n    {\n      id: \"fetcher\",\n      strict: true,\n      preserveActionOrder: true,\n\n      tsTypes: {} as import(\"./Fetcher.typegen\").Typegen0,\n      schema: {\n        context: {} as Context,\n        events: {} as Event,\n        services: {} as ServiceEvents,\n      },\n      context: {},\n\n      type: \"parallel\",\n      states: {\n        // @todo Support pending request state\n        request: {\n          initial: \"checking\",\n          states: {\n            checking: {\n              always: [\n                {\n                  cond: \"isDisabled\",\n                  target: \"disabled\",\n                },\n                {\n                  cond: \"shouldLoad\",\n                  target: \"loading\",\n                },\n                \"idle\",\n              ],\n            },\n\n            idle: {},\n\n            disabled: {},\n\n            loading: {\n              entry: [\"setCurrentAborter\", \"setCurrentFetch\"],\n\n              invoke: {\n                id: \"currentFetch\",\n                src: \"currentFetch\",\n\n                onDone: {\n                  target: [\"loaded\", \"#fetcher.response.checking\"],\n                  actions: [\n                    \"setData\",\n                    \"setTimestamp\",\n                    \"validate\",\n                    \"clearCurrentAborter\",\n                    \"clearCurrentFetch\",\n                  ],\n                },\n\n                onError: {\n                  target: \"failed\",\n                  actions: [\"clearCurrentAborter\", \"clearCurrentFetch\"],\n                },\n              },\n            },\n\n            loaded: {},\n\n            aborted: {\n              after: {\n                AUTO_RESET_TIME: {\n                  cond: \"isLimitedAutoResetTime\",\n                  target: \"checking\",\n                },\n              },\n            },\n\n            failed: {\n              after: {\n                AUTO_RESET_TIME: {\n                  cond: \"isLimitedAutoResetTime\",\n                  target: \"checking\",\n                },\n              },\n            },\n          },\n\n          on: {\n            LOAD: {\n              target: \"request.checking\",\n              actions: [\n                \"abortCurrentFetch\",\n                \"clearCurrentAborter\",\n                \"clearCurrentFetch\",\n              ],\n            },\n\n            ABORT: {\n              target: \"request.aborted\",\n              actions: [\n                \"abortCurrentFetch\",\n                \"clearCurrentAborter\",\n                \"clearCurrentFetch\",\n              ],\n            },\n          },\n        },\n\n        response: {\n          initial: \"checking\",\n          states: {\n            checking: {\n              always: [\n                {\n                  cond: \"isFresh\",\n                  target: \"fresh\",\n                },\n                {\n                  cond: \"isStale\",\n                  target: \"stale\",\n                },\n                \"none\",\n              ],\n            },\n\n            none: {},\n            stale: {},\n\n            fresh: {\n              after: {\n                //@ todo Prevent unncessary event with new substate?\n                REMAINING_FRESH_TIME: {\n                  cond: \"isLimitedFreshTime\",\n                  target: [\"stale\", \"#fetcher.request.checking\"],\n                },\n              },\n            },\n          },\n        },\n      },\n\n      entry: [\"setDefaultOptions\", \"setData\", \"setTimestamp\"],\n\n      on: {\n        SET_OPTIONS: {\n          target: [\".request.checking\", \".response.checking\"],\n          actions: [\n            \"setOptions\",\n            \"setDefaultOptions\",\n            \"setData\",\n            \"setTimestamp\",\n            \"invalidate\",\n            \"abortCurrentFetch\",\n            \"clearCurrentAborter\",\n            \"clearCurrentFetch\",\n          ],\n        },\n\n        SET_DATA: {\n          target: [\".request.checking\", \".response.checking\"],\n          actions: [\n            \"setData\",\n            \"setTimestamp\",\n            \"validate\",\n            \"abortCurrentFetch\",\n            \"clearCurrentAborter\",\n            \"clearCurrentFetch\",\n          ],\n        },\n\n        SET_TIMESTAMP: {\n          target: [\".request.checking\", \".response.checking\"],\n          actions: [\n            \"setTimestamp\",\n            \"abortCurrentFetch\",\n            \"clearCurrentAborter\",\n            \"clearCurrentFetch\",\n          ],\n        },\n\n        INVALIDATE: {\n          target: [\".request.checking\", \".response.checking\"],\n          actions: [\n            \"invalidate\",\n            \"abortCurrentFetch\",\n            \"clearCurrentAborter\",\n            \"clearCurrentFetch\",\n          ],\n        },\n\n        ENABLE: {\n          target: \".request.checking\",\n          actions: [\n            \"enable\",\n            \"abortCurrentFetch\",\n            \"clearCurrentAborter\",\n            \"clearCurrentFetch\",\n          ],\n        },\n\n        DISABLE: {\n          target: \".request.checking\",\n          actions: [\n            \"disable\",\n            \"abortCurrentFetch\",\n            \"clearCurrentAborter\",\n            \"clearCurrentFetch\",\n          ],\n        },\n\n        RESET: {\n          target: [\".request.checking\", \".response.checking\"],\n          actions: [\n            \"clearData\",\n            \"clearTimestamp\",\n            \"abortCurrentFetch\",\n            \"clearCurrentAborter\",\n            \"clearCurrentFetch\",\n          ],\n        },\n      },\n    },\n    {\n      guards: {\n        isDisabled: (context) => context.isDisabled === true,\n\n        shouldLoad: (context, _event, meta) => {\n          const event = getLastEvent<\n            | Event\n            | { type: \"xstate.init\" }\n            | {\n                type: \"xstate.after(REMAINING_FRESH_TIME)#fetcher.response.fresh\";\n              }\n            | {\n                type: \"xstate.after(AUTO_RESET_TIME)#fetcher.request.aborted\";\n              }\n            | { type: \"xstate.after(AUTO_RESET_TIME)#fetcher.request.failed\" }\n          >(meta.state);\n\n          return (\n            context.fetchFn !== undefined &&\n            (event.type !== \"xstate.init\" || context.loadOnInvoke === true) &&\n            (event.type !==\n              \"xstate.after(REMAINING_FRESH_TIME)#fetcher.response.fresh\" ||\n              context.loadWhenStale === true) &&\n            ((event.type !==\n              \"xstate.after(AUTO_RESET_TIME)#fetcher.request.aborted\" &&\n              event.type !==\n                \"xstate.after(AUTO_RESET_TIME)#fetcher.request.failed\") ||\n              context.loadOnAutoReset === true) &&\n            (event.type !== \"INVALIDATE\" ||\n              context.loadOnInvalidate === true) &&\n            (event.type !== \"ENABLE\" || context.loadOnEnable === true) &&\n            (event.type !== \"RESET\" || context.loadOnReset === true) &&\n            (context.data === undefined ||\n              Date.now() - context.timestamp! > context.freshTime! ||\n              (event.type === \"LOAD\" && (event.data?.refresh ?? false)) ||\n              (event.type === \"ENABLE\" && (event.data?.refresh ?? false)) ||\n              context.isInvalid === true ||\n              context.currentFetch !== undefined)\n          );\n        },\n\n        isFresh: (context) =>\n          context.data !== undefined &&\n          Date.now() - context.timestamp! <= context.freshTime! &&\n          context.isInvalid === false,\n\n        isStale: (context) =>\n          (context.data !== undefined &&\n            Date.now() - context.timestamp! > context.freshTime!) ||\n          context.isInvalid === true,\n\n        isLimitedFreshTime: (context) =>\n          context.freshTime !== Number.POSITIVE_INFINITY,\n\n        isLimitedAutoResetTime: (context) =>\n          context.autoResetTime !== Number.POSITIVE_INFINITY,\n      },\n\n      delays: {\n        REMAINING_FRESH_TIME: (context) =>\n          context.freshTime !== Number.POSITIVE_INFINITY\n            ? Math.max(\n                context.freshTime! - (Date.now() - context.timestamp!),\n                0\n              )\n            : 0,\n\n        AUTO_RESET_TIME: (context) =>\n          context.autoResetTime !== Number.POSITIVE_INFINITY\n            ? context.autoResetTime!\n            : 0,\n      },\n\n      actions: {\n        setDefaultOptions: actions.assign((context) => ({\n          type: context.type ?? \"QUERY\",\n\n          timestampFn: context.timestampFn ?? (() => Date.now()),\n          aborterFn: context.aborterFn ?? (() => new AbortController()),\n\n          isInvalid: context.isInvalid ?? false,\n          isDisabled: context.isDisabled ?? false,\n\n          freshTime: context.freshTime ?? Number.POSITIVE_INFINITY,\n          autoResetTime: context.autoResetTime ?? Number.POSITIVE_INFINITY,\n\n          loadOnInvoke: context.loadOnInvoke ?? context.type !== \"MUTATION\",\n          loadOnInvalidate:\n            context.loadOnInvalidate ?? context.type !== \"MUTATION\",\n          loadOnEnable: context.loadOnEnable ?? context.type !== \"MUTATION\",\n          loadOnReset: context.loadOnReset ?? context.type !== \"MUTATION\",\n          loadOnAutoReset:\n            context.loadOnAutoReset ?? context.type !== \"MUTATION\",\n          loadWhenStale: context.loadWhenStale ?? context.type !== \"MUTATION\",\n        })),\n\n        // @todo Check validity of provided option values\n        setOptions: actions.assign((context, event) => ({\n          ...context,\n          ...event.data,\n        })),\n\n        // @todo Ignore new data if it has older timestamp\n        // @todo Merge new data with old one using structural equality\n        setData: actions.assign((context, event) => ({\n          data:\n            event.type === \"xstate.init\"\n              ? context.initialData\n              : event.type === \"done.invoke.currentFetch\"\n              ? event.data.data\n              : event.type === \"SET_OPTIONS\" && context.data === undefined\n              ? context.initialData\n              : event.type === \"SET_DATA\"\n              ? event.data\n              : context.data,\n        })),\n\n        clearData: actions.assign((context, event) => ({\n          data: event.data?.clear ?? false ? undefined : context.data,\n        })),\n\n        setTimestamp: actions.assign((context, event, meta) => ({\n          timestamp:\n            event.type === \"xstate.init\" && context.data !== undefined\n              ? context.initialTimestamp ?? Date.now()\n              : event.type === \"done.invoke.currentFetch\"\n              ? context.data === undefined\n                ? undefined\n                : context.timestampFn!(event.data)\n              : event.type === \"SET_OPTIONS\" &&\n                meta.state!.context.data === undefined\n              ? context.initialTimestamp ?? Date.now()\n              : event.type === \"SET_DATA\"\n              ? context.data === undefined\n                ? undefined\n                : event.data.timestamp ?? Date.now()\n              : event.type === \"SET_TIMESTAMP\" && context.data !== undefined\n              ? event.data.timestamp\n              : context.timestamp,\n        })),\n\n        clearTimestamp: actions.assign((context, event) => ({\n          timestamp: event.data?.clear ?? false ? undefined : context.timestamp,\n        })),\n\n        validate: actions.assign((_context) => ({\n          isInvalid: false,\n        })),\n\n        invalidate: actions.assign((context, event, meta) => ({\n          isInvalid:\n            (event.type === \"SET_OPTIONS\" &&\n              context.fetchFn !== meta.state!.context.fetchFn) ||\n            event.type === \"INVALIDATE\"\n              ? true\n              : context.isInvalid,\n        })),\n\n        enable: actions.assign((_context) => ({\n          isDisabled: false,\n        })),\n\n        disable: actions.assign((_context) => ({\n          isDisabled: false,\n        })),\n\n        setCurrentAborter: actions.assign((context) => ({\n          currentAborter:\n            context.aborterFn !== false && context.currentAborter === undefined\n              ? context.aborterFn!()\n              : context.currentAborter,\n        })),\n\n        clearCurrentAborter: actions.assign((context, event, meta) => ({\n          currentAborter:\n            event.type === \"done.invoke.currentFetch\" ||\n            event.type === \"error.platform.currentFetch\" ||\n            (event.type === \"SET_OPTIONS\" &&\n              (event.data.abort === true ||\n                (event.data.abort === undefined &&\n                  context.fetchFn !== meta.state!.context.fetchFn))) ||\n            (event.type === \"SET_DATA\" && event.data.abort !== false) ||\n            (event.type === \"SET_TIMESTAMP\" && event.data.abort === true) ||\n            event.type === \"INVALIDATE\" ||\n            (event.type === \"ENABLE\" && (event.data?.abort ?? false)) ||\n            (event.type === \"DISABLE\" && (event.data?.abort ?? false)) ||\n            (event.type === \"LOAD\" && (event.data?.abort ?? false)) ||\n            event.type === \"ABORT\" ||\n            event.type === \"RESET\"\n              ? undefined\n              : context.currentAborter,\n        })),\n\n        setCurrentFetch: actions.assign((context) => ({\n          currentFetch:\n            context.currentFetch === undefined\n              ? context.fetchFn!({ aborter: context.currentAborter! })\n              : context.currentFetch,\n        })),\n\n        clearCurrentFetch: actions.assign((context, event, meta) => ({\n          currentFetch:\n            event.type === \"done.invoke.currentFetch\" ||\n            event.type === \"error.platform.currentFetch\" ||\n            (event.type === \"SET_OPTIONS\" &&\n              (event.data.abort === true ||\n                (event.data.abort === undefined &&\n                  context.fetchFn !== meta.state!.context.fetchFn))) ||\n            (event.type === \"SET_DATA\" && event.data.abort !== false) ||\n            (event.type === \"SET_TIMESTAMP\" && event.data.abort === true) ||\n            event.type === \"INVALIDATE\" ||\n            (event.type === \"ENABLE\" && (event.data?.abort ?? false)) ||\n            (event.type === \"DISABLE\" && (event.data?.abort ?? false)) ||\n            (event.type === \"LOAD\" && (event.data?.abort ?? false)) ||\n            event.type === \"ABORT\" ||\n            event.type === \"RESET\"\n              ? undefined\n              : context.currentFetch,\n        })),\n\n        abortCurrentFetch: (context, event, meta) => {\n          if (\n            context.currentAborter !== undefined &&\n            ((event.type === \"SET_OPTIONS\" &&\n              (event.data.abort === true ||\n                (event.data.abort === undefined &&\n                  context.fetchFn !== meta.state!.context.fetchFn))) ||\n              (event.type === \"SET_DATA\" && event.data.abort !== false) ||\n              (event.type === \"SET_TIMESTAMP\" && event.data.abort === true) ||\n              event.type === \"INVALIDATE\" ||\n              (event.type === \"ENABLE\" && (event.data?.abort ?? false)) ||\n              (event.type === \"DISABLE\" && (event.data?.abort ?? false)) ||\n              (event.type === \"LOAD\" && (event.data?.abort ?? false)) ||\n              event.type === \"ABORT\" ||\n              event.type === \"RESET\")\n          ) {\n            context.currentAborter!.abort(event);\n          }\n        },\n      },\n\n      services: {\n        currentFetch: (context) => () => context.currentFetch,\n      },\n    }\n  );\n\n  return fetcher.withContext({\n    ...fetcher.context,\n    ...options,\n  });\n};\n\ntype Machine = ReturnType<typeof createFetcher>;\ntype Interpreter = InterpreterFrom<Machine>;\ntype State = StateFrom<Machine>;\n\n/*\n@todo Add options for:\n  keepPreviousData\n  retrying\n  loadOnInterval\n  loadOnRefocus\n  loadOnReconnect\n*/\ntype Context = {\n  type?: Type;\n\n  fetchFn?: FetchFn;\n  timestampFn?: TimestampFn;\n  aborterFn?: AborterFn | false;\n\n  currentFetch?: Promise<any>;\n  currentAborter?: Aborter;\n\n  data?: any;\n  initialData?: any;\n  placeholderData?: any;\n\n  timestamp?: number;\n  initialTimestamp?: number;\n\n  isInvalid?: boolean;\n  isDisabled?: boolean;\n\n  freshTime?: number;\n  autoResetTime?: number;\n\n  loadOnInvoke?: boolean;\n  loadOnInvalidate?: boolean;\n  loadOnEnable?: boolean;\n  loadOnReset?: boolean;\n  loadOnAutoReset?: boolean;\n  loadWhenStale?: boolean;\n};\n\ntype FetcherOptions = Partial<\n  Pick<\n    Context,\n    | \"type\"\n    | \"fetchFn\"\n    | \"timestampFn\"\n    | \"aborterFn\"\n    | \"initialData\"\n    | \"initialTimestamp\"\n    | \"placeholderData\"\n    | \"isInvalid\"\n    | \"isDisabled\"\n    | \"freshTime\"\n    | \"autoResetTime\"\n    | \"loadOnInvoke\"\n    | \"loadOnInvalidate\"\n    | \"loadOnEnable\"\n    | \"loadOnReset\"\n    | \"loadOnAutoReset\"\n    | \"loadWhenStale\"\n  >\n>;\n\ntype Type = \"QUERY\" | \"MUTATION\";\n\ntype FetchFn = (parameters: { aborter: Aborter }) => Promise<any>;\ntype TimestampFn = (data: any) => number;\ntype AborterFn = () => Aborter;\n\ntype Aborter = {\n  abort: (reason: Event) => void;\n  signal: any;\n};\n\ntype Event =\n  | SetOptionsEvent\n  | SetDataEvent\n  | SetTimestampEvent\n  | InvalidateEvent\n  | EnableEvent\n  | DisableEvent\n  | LoadEvent\n  | AbortEvent\n  | ResetEvent;\n\ntype SetOptionsEvent = {\n  type: \"SET_OPTIONS\";\n  data: FetcherOptions & { abort?: boolean };\n};\n\ntype SetDataEvent = {\n  type: \"SET_DATA\";\n  data: {\n    data: any;\n    timestamp?: number;\n    abort?: boolean;\n  };\n};\n\ntype SetTimestampEvent = {\n  type: \"SET_TIMESTAMP\";\n  data: {\n    timestamp: number;\n    abort?: boolean;\n  };\n};\n\ntype InvalidateEvent = { type: \"INVALIDATE\" };\n\ntype EnableEvent = {\n  type: \"ENABLE\";\n  data?: {\n    abort?: boolean;\n    refresh?: boolean;\n  };\n};\n\ntype DisableEvent = {\n  type: \"DISABLE\";\n  data?: { abort?: boolean };\n};\n\ntype LoadEvent = {\n  type: \"LOAD\";\n  data?: {\n    abort?: boolean;\n    refresh?: boolean;\n  };\n};\n\ntype AbortEvent = {\n  type: \"ABORT\";\n  data?: { reason?: any };\n};\n\ntype ResetEvent = {\n  type: \"RESET\";\n  data?: { clear?: boolean };\n};\n\ntype ServiceEvents = { currentFetch: CurrentFetchServiceEvent };\ntype CurrentFetchServiceEvent = DoneInvokeEvent<{ data: any }>;\n\nexport {\n  createFetcher,\n  type AborterFn,\n  type Aborter,\n  type Context,\n  type Event,\n  type FetchFn,\n  type FetcherOptions,\n  type Interpreter,\n  type Machine,\n  type State,\n  type TimestampFn,\n  type Type,\n};\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nexports.__assign = function() {\r\n    exports.__assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return exports.__assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nexports.__read = __read;\nexports.__rest = __rest;\nexports.__spreadArray = __spreadArray;\nexports.__values = __values;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar STATE_DELIMITER = '.';\nvar EMPTY_ACTIVITY_MAP = {};\nvar DEFAULT_GUARD_TYPE = 'xstate.guard';\nvar TARGETLESS_KEY = '';\n\nexports.DEFAULT_GUARD_TYPE = DEFAULT_GUARD_TYPE;\nexports.EMPTY_ACTIVITY_MAP = EMPTY_ACTIVITY_MAP;\nexports.STATE_DELIMITER = STATE_DELIMITER;\nexports.TARGETLESS_KEY = TARGETLESS_KEY;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar IS_PRODUCTION = process.env.NODE_ENV === 'production';\n\nexports.IS_PRODUCTION = IS_PRODUCTION;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar _tslib = require('./_virtual/_tslib.js');\nvar constants = require('./constants.js');\nvar environment = require('./environment.js');\n\nvar _a;\nfunction keys(value) {\n  return Object.keys(value);\n}\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = constants.STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return Object.keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\".concat(event) : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\nfunction getActionType(action) {\n  try {\n    return isString(action) || typeof action === 'number' ? \"\".concat(action) : isFunction(action) ? action.name : action.type;\n  } catch (e) {\n    throw new Error('Actions must be strings or objects with a string action.type property.');\n  }\n}\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\".concat(stateId, \"' is not a valid state path.\"));\n  }\n}\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = Object.keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = _tslib.__values(Object.keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = _tslib.__values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = _tslib.__values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(Object.keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\nfunction pathsToStateValue(paths) {\n  var e_4, _a;\n\n  var result = {};\n\n  if (paths && paths.length === 1 && paths[0].length === 1) {\n    return paths[0][0];\n  }\n\n  try {\n    for (var paths_1 = _tslib.__values(paths), paths_1_1 = paths_1.next(); !paths_1_1.done; paths_1_1 = paths_1.next()) {\n      var currentPath = paths_1_1.value;\n      var marker = result; // tslint:disable-next-line:prefer-for-of\n\n      for (var i = 0; i < currentPath.length; i++) {\n        var subPath = currentPath[i];\n\n        if (i === currentPath.length - 2) {\n          marker[subPath] = currentPath[i + 1];\n          break;\n        }\n\n        marker[subPath] = marker[subPath] || {};\n        marker = marker[subPath];\n      }\n    }\n  } catch (e_4_1) {\n    e_4 = {\n      error: e_4_1\n    };\n  } finally {\n    try {\n      if (paths_1_1 && !paths_1_1.done && (_a = paths_1.return)) _a.call(paths_1);\n    } finally {\n      if (e_4) throw e_4.error;\n    }\n  }\n\n  return result;\n}\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, _tslib.__spreadArray([], _tslib.__read(array), false));\n}\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = _tslib.__values(Object.keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\nfunction isBehavior(value) {\n  return value !== null && typeof value === 'object' && 'transition' in value && typeof value.transition === 'function';\n}\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = _tslib.__read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = _tslib.__values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\nfunction updateContext(context, _event, assignActions, state) {\n  if (!environment.IS_PRODUCTION) {\n    exports.warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = _tslib.__values(Object.keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\nexports.warn = function () {};\n\nif (!environment.IS_PRODUCTION) {\n  exports.warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \".concat(message)];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\nfunction isString(value) {\n  return typeof value === 'string';\n}\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: constants.DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: constants.DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\nvar symbolObservable = /*#__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}(); // TODO: to be removed in v5, left it out just to minimize the scope of the change and maintain compatibility with older versions of integration paackages\n\nvar interopSymbols = (_a = {}, _a[symbolObservable] = function () {\n  return this;\n}, _a[Symbol.observable] = function () {\n  return this;\n}, _a);\nfunction isMachine(value) {\n  return !!value && '__xstatenode' in value;\n}\nfunction isActor(value) {\n  return !!value && typeof value.send === 'function';\n}\nvar uniqueId = /*#__PURE__*/function () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return _tslib.__assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return _tslib.__assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return _tslib.__assign(_tslib.__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\nfunction normalizeTarget(target) {\n  if (target === undefined || target === constants.TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!environment.IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\".concat(originalError.stack, \"'\") : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\".concat(id, \"', error was '\").concat(originalError, \"'.\").concat(originalStackTrace));\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\".concat(currentError.stack, \"'\") : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\".concat(id, \"'. \") + \"Original error: '\".concat(originalError, \"'. \").concat(originalStackTrace, \" Current error is '\").concat(currentError, \"'.\").concat(stackTrace));\n    }\n  }\n}\nfunction evaluateGuard(machine, guard, context, _event, state) {\n  var guards = machine.options.guards;\n  var guardMeta = {\n    state: state,\n    cond: guard,\n    _event: _event\n  }; // TODO: do not hardcode!\n\n  if (guard.type === constants.DEFAULT_GUARD_TYPE) {\n    return ((guards === null || guards === void 0 ? void 0 : guards[guard.name]) || guard.predicate)(context, _event.data, guardMeta);\n  }\n\n  var condFn = guards === null || guards === void 0 ? void 0 : guards[guard.type];\n\n  if (!condFn) {\n    throw new Error(\"Guard '\".concat(guard.type, \"' is not implemented on machine '\").concat(machine.id, \"'.\"));\n  }\n\n  return condFn(context, _event.data, guardMeta);\n}\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    return {\n      type: src\n    };\n  }\n\n  return src;\n}\nfunction toObserver(nextHandler, errorHandler, completionHandler) {\n  var noop = function () {};\n\n  var isObserver = typeof nextHandler === 'object';\n  var self = isObserver ? nextHandler : null;\n  return {\n    next: ((isObserver ? nextHandler.next : nextHandler) || noop).bind(self),\n    error: ((isObserver ? nextHandler.error : errorHandler) || noop).bind(self),\n    complete: ((isObserver ? nextHandler.complete : completionHandler) || noop).bind(self)\n  };\n}\nfunction createInvokeId(stateNodeId, index) {\n  return \"\".concat(stateNodeId, \":invocation[\").concat(index, \"]\");\n}\n\nexports.createInvokeId = createInvokeId;\nexports.evaluateGuard = evaluateGuard;\nexports.flatten = flatten;\nexports.getActionType = getActionType;\nexports.getEventType = getEventType;\nexports.interopSymbols = interopSymbols;\nexports.isActor = isActor;\nexports.isArray = isArray;\nexports.isBehavior = isBehavior;\nexports.isBuiltInEvent = isBuiltInEvent;\nexports.isFunction = isFunction;\nexports.isMachine = isMachine;\nexports.isObservable = isObservable;\nexports.isPromiseLike = isPromiseLike;\nexports.isStateLike = isStateLike;\nexports.isString = isString;\nexports.keys = keys;\nexports.mapContext = mapContext;\nexports.mapFilterValues = mapFilterValues;\nexports.mapValues = mapValues;\nexports.matchesState = matchesState;\nexports.nestedPath = nestedPath;\nexports.normalizeTarget = normalizeTarget;\nexports.partition = partition;\nexports.path = path;\nexports.pathToStateValue = pathToStateValue;\nexports.pathsToStateValue = pathsToStateValue;\nexports.reportUnhandledExceptionOnInvocation = reportUnhandledExceptionOnInvocation;\nexports.symbolObservable = symbolObservable;\nexports.toArray = toArray;\nexports.toArrayStrict = toArrayStrict;\nexports.toEventObject = toEventObject;\nexports.toGuard = toGuard;\nexports.toInvokeSource = toInvokeSource;\nexports.toObserver = toObserver;\nexports.toSCXMLEvent = toSCXMLEvent;\nexports.toStatePath = toStatePath;\nexports.toStatePaths = toStatePaths;\nexports.toStateValue = toStateValue;\nexports.toTransitionConfigArray = toTransitionConfigArray;\nexports.uniqueId = uniqueId;\nexports.updateContext = updateContext;\nexports.updateHistoryStates = updateHistoryStates;\nexports.updateHistoryValue = updateHistoryValue;\n","import {\n  createMachine,\n  interpret,\n  type AnyInterpreter,\n  type AnyEventObject,\n  type AnyState,\n  type AnyStateMachine,\n  type InvokeCallback,\n  type Subscription,\n} from \"xstate\";\nimport { isMachine } from \"xstate/lib/utils\";\n\nimport { getLastEvent } from \"@src/LastEvent\";\n\nconst interceptor = createMachine({\n  id: \"interceptor\",\n  strict: false,\n  preserveActionOrder: true,\n});\n\nconst createProxy = (\n  machineOrInterpreter: AnyStateMachine | AnyInterpreter,\n  options: ProxyOptions = {}\n): Proxy => {\n  const proxy: Proxy = (sendBack, on) => {\n    const interpreter = isMachine(machineOrInterpreter)\n      ? interpret(machineOrInterpreter)\n      : machineOrInterpreter;\n    const { mapFn, autoStart, autoStop, cleanFn } = options;\n\n    proxy.interpreter = interpreter;\n\n    if (interpreter.parent !== undefined) {\n      if ((interpreter.parent.machine as AnyStateMachine) !== interceptor) {\n        throw new Error(\n          \"Cannot proxy a machine/interpreter with an assigned parent!\"\n        );\n      }\n    } else {\n      interpreter.parent = interpret(interceptor).start() as AnyInterpreter;\n    }\n\n    on((event) => interpreter.send(event));\n\n    let interpreterUnsubscribeFn: Subscription[\"unsubscribe\"];\n    let interceptorUnsubscribeFn: Subscription[\"unsubscribe\"];\n    let isInterceptorInitialized = false;\n\n    if (mapFn !== undefined) {\n      interpreterUnsubscribeFn = interpreter.subscribe((state) => {\n        const mappedEvent = mapFn({ state, event: getLastEvent(state) });\n\n        if (mappedEvent !== undefined) {\n          sendBack(mappedEvent);\n        }\n      }).unsubscribe;\n\n      interceptorUnsubscribeFn = interpreter.parent.subscribe((state) => {\n        if (isInterceptorInitialized) {\n          const mappedEvent = mapFn({\n            state: interpreter.state,\n            event: getLastEvent(state),\n          });\n\n          if (mappedEvent !== undefined) {\n            sendBack(mappedEvent);\n          }\n        }\n\n        isInterceptorInitialized = true;\n      }).unsubscribe;\n    }\n\n    if (\n      autoStart === true ||\n      (autoStart === undefined && isMachine(machineOrInterpreter))\n    ) {\n      interpreter.start();\n    }\n\n    return () => {\n      if (cleanFn !== undefined) {\n        cleanFn();\n      }\n\n      if (mapFn !== undefined) {\n        interpreterUnsubscribeFn();\n        interceptorUnsubscribeFn();\n      }\n\n      if (\n        autoStop === true ||\n        (autoStart === undefined && isMachine(machineOrInterpreter))\n      ) {\n        interpreter.stop();\n      }\n    };\n  };\n\n  return proxy;\n};\n\ntype Proxy = InvokeCallback & { interpreter?: AnyInterpreter };\n\ntype ProxyOptions = {\n  mapFn?: MapFn;\n  cleanFn?: CleanFn;\n\n  autoStart?: boolean;\n  autoStop?: boolean;\n};\n\ntype MapFn = (parameters: MapFnParameters) => AnyEventObject | void;\n\ntype MapFnParameters = {\n  state: AnyState;\n  event: AnyEventObject;\n};\n\ntype CleanFn = () => void;\n\nexport { createProxy, type Proxy, type ProxyOptions };\n","import { interpret } from \"xstate\";\n\nimport {\n  Cache,\n  type Key,\n  type CacheOptions,\n  type Subscription,\n  type SubscribeFnParameters,\n} from \"@src/Cache\";\n\nimport {\n  createFetcher,\n  type Event,\n  type Interpreter,\n  type FetcherOptions,\n} from \"@src/Fetcher\";\n\nimport { createProxy, type ProxyOptions, type Proxy } from \"@src/Proxy\";\n\nconst useFetcher = (options: Options = {}): Proxy => {\n  const { key, cache, synchronizations, cleanFn } = options;\n\n  let fetcher: Interpreter;\n\n  if (cache !== undefined) {\n    if (cache.has(key)) {\n      fetcher = cache.get(key).fetcher;\n    } else {\n      fetcher = interpret(createFetcher(options));\n\n      cache.set(key, fetcher, options);\n    }\n\n    if (synchronizations !== undefined) {\n      const subscriptions = synchronizations.map<Subscription>(\n        (synchronization) => ({\n          ...synchronization,\n          subscribeFn: (parameters) => {\n            const synchronizationEvent = synchronization.synchronizeFn({\n              ...parameters,\n              fetcher,\n              cache,\n            });\n\n            if (synchronizationEvent !== undefined) {\n              fetcher.send(synchronizationEvent);\n            }\n          },\n        })\n      );\n\n      const unsubscribeFn = cache.subscribe(subscriptions);\n\n      options.cleanFn = () => {\n        if (cleanFn !== undefined) {\n          cleanFn();\n        }\n\n        unsubscribeFn();\n\n        cache.deactivate(key);\n      };\n\n      cache.activate(key);\n    }\n  } else {\n    fetcher = interpret(createFetcher(options));\n  }\n\n  return createProxy(fetcher, { ...options, autoStart: true });\n};\n\ntype Options = FetcherOptions &\n  CacheOptions &\n  Pick<ProxyOptions, \"mapFn\" | \"cleanFn\"> & {\n    key?: Key;\n    cache?: Cache;\n    synchronizations?: Synchronization[];\n  };\n\ntype Synchronization = Omit<Subscription, \"subscribeFn\"> & {\n  synchronizeFn: SynchronizeFn;\n};\n\ntype SynchronizeFn = (parameters: SynchronizeFnParameters) => Event | void;\n\ntype SynchronizeFnParameters = SubscribeFnParameters & {\n  fetcher: Interpreter;\n  cache: Cache;\n};\n\nexport {\n  useFetcher,\n  type Options,\n  type Synchronization,\n  type SynchronizeFn,\n  type SynchronizeFnParameters,\n};\n"],"names":["createCache","Cache","__publicField","key","fetcher","options","entryIndex","cacheTime","keepActive","entry","state","batchFn","subscriptions","subscription","subscriptionIndex","subscribeFnIndex","sourceKey","targetKey","isExact","sourceKeyKeys","targetKeyKeys","_a","subscriptionKey","subscribeFn","getLastEvent","createFetcher","createMachine","context","_event","meta","event","_b","_d","_c","actions","_e","_f","_g","_h","_i","_j","_k","_l","_m","_context","exports","t","s","i","n","p","__rest","e","__values","o","m","__read","r","ar","error","__spreadArray","to","from","pack","l","constants","STATE_DELIMITER","EMPTY_ACTIVITY_MAP","DEFAULT_GUARD_TYPE","TARGETLESS_KEY","environment","IS_PRODUCTION","_tslib","require$$0","require$$1","require$$2","keys","value","matchesState","parentStateId","childStateId","delimiter","parentStateValue","toStateValue","childStateValue","isString","getEventType","getActionType","action","isFunction","toStatePath","stateId","isArray","isStateLike","stateValue","pathToStateValue","statePath","marker","mapValues","collection","iteratee","result","collectionKeys","mapFilterValues","predicate","e_1","item","e_1_1","path","props","object","e_2","props_1","props_1_1","prop","e_2_1","nestedPath","accessorProp","e_3","props_2","props_2_1","e_3_1","toStatePaths","flatten","subStateValue","subPath","pathsToStateValue","paths","e_4","paths_1","paths_1_1","currentPath","e_4_1","array","toArrayStrict","toArray","mapContext","mapper","e_5","subMapper","e_5_1","isBuiltInEvent","eventType","isPromiseLike","isBehavior","partition","items","e_6","truthy","falsy","items_1","items_1_1","e_6_1","updateHistoryStates","hist","subHist","updateHistoryValue","updateContext","assignActions","updatedContext","acc","assignAction","e_7","assignment","partialUpdate","propAssignment","e_7_1","condition","message","args","toGuard","guardMap","isObservable","symbolObservable","interopSymbols","isMachine","isActor","uniqueId","currentId","toEventObject","payload","toSCXMLEvent","scxmlEvent","eventObject","toTransitionConfigArray","configLike","transitions","transitionLike","normalizeTarget","target","reportUnhandledExceptionOnInvocation","originalError","currentError","id","originalStackTrace","stackTrace","evaluateGuard","machine","guard","guards","guardMeta","condFn","toInvokeSource","src","toObserver","nextHandler","errorHandler","completionHandler","noop","isObserver","self","createInvokeId","stateNodeId","index","interceptor","createProxy","machineOrInterpreter","proxy","sendBack","on","interpreter","interpret","mapFn","autoStart","autoStop","cleanFn","interpreterUnsubscribeFn","interceptorUnsubscribeFn","isInterceptorInitialized","mappedEvent","useFetcher","cache","synchronizations","synchronization","parameters","synchronizationEvent","unsubscribeFn"],"mappings":"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"}